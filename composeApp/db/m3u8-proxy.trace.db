2025-08-19 11:51:32.595931+08:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLTransactionRollbackException: Deadlock detected. The current transaction was rolled back. Details: "TASKS"; SQL statement:
UPDATE TASKS SET PROGRESS=? WHERE TASKS.ID = ? [40001-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:524)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.mvstore.db.MVTable.convertException(MVTable.java:699)
	at org.h2.mvstore.db.MVTable.convertLockException(MVTable.java:689)
	at org.h2.mvstore.db.MVPrimaryIndex.lockRow(MVPrimaryIndex.java:227)
	at org.h2.mvstore.db.MVPrimaryIndex.lockRow(MVPrimaryIndex.java:220)
	at org.h2.mvstore.db.MVTable.lockRow(MVTable.java:555)
	at org.h2.command.dml.Update.update(Update.java:70)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:169)
	at org.h2.command.Command.executeUpdate(Command.java:256)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:216)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:174)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.jetbrains.exposed.v1.jdbc.statements.jdbc.JdbcPreparedStatementImpl.executeUpdate(JdbcPreparedStatementImpl.kt:55)
	at org.jetbrains.exposed.v1.jdbc.statements.UpdateBlockingExecutable.executeInternal(UpdateBlockingExecutable.kt:17)
	at org.jetbrains.exposed.v1.jdbc.statements.UpdateBlockingExecutable.executeInternal(UpdateBlockingExecutable.kt:11)
	at org.jetbrains.exposed.v1.jdbc.statements.BlockingExecutableKt.executeIn(BlockingExecutable.kt:156)
	at org.jetbrains.exposed.v1.jdbc.JdbcTransaction.exec(JdbcTransaction.kt:210)
	at org.jetbrains.exposed.v1.jdbc.JdbcTransaction.exec(JdbcTransaction.kt:187)
	at org.jetbrains.exposed.v1.jdbc.statements.BlockingExecutable$DefaultImpls.execute(BlockingExecutable.kt:76)
	at org.jetbrains.exposed.v1.jdbc.statements.UpdateBlockingExecutable.execute(UpdateBlockingExecutable.kt:11)
	at org.jetbrains.exposed.v1.jdbc.statements.UpdateBlockingExecutable.execute(UpdateBlockingExecutable.kt:11)
	at org.jetbrains.exposed.v1.jdbc.QueriesKt.update(Queries.kt:544)
	at org.jetbrains.exposed.v1.jdbc.QueriesKt.update$default(Queries.kt:535)
	at cn.com.lushunming.service.TaskService.updateProgress$lambda$6(TaskService.kt:39)
	at cn.com.lushunming.service.DatabaseFactory.dbQuery$lambda$1(DatabaseFactory.kt:48)
	at org.jetbrains.exposed.v1.jdbc.transactions.TransactionManagerKt.inTopLevelTransaction$run(TransactionManager.kt:418)
	at org.jetbrains.exposed.v1.jdbc.transactions.TransactionManagerKt.inTopLevelTransaction$lambda$11(TransactionManager.kt:465)
	at org.jetbrains.exposed.v1.jdbc.transactions.TransactionManagerKt.keepAndRestoreTransactionRefAfterRun(TransactionManager.kt:473)
	at org.jetbrains.exposed.v1.jdbc.transactions.TransactionManagerKt.inTopLevelTransaction(TransactionManager.kt:464)
	at org.jetbrains.exposed.v1.jdbc.transactions.TransactionManagerKt.transaction$lambda$5(TransactionManager.kt:373)
	at org.jetbrains.exposed.v1.jdbc.transactions.TransactionManagerKt.keepAndRestoreTransactionRefAfterRun(TransactionManager.kt:473)
	at org.jetbrains.exposed.v1.jdbc.transactions.TransactionManagerKt.transaction(TransactionManager.kt:322)
	at org.jetbrains.exposed.v1.jdbc.transactions.TransactionManagerKt.transaction(TransactionManager.kt:300)
	at cn.com.lushunming.service.DatabaseFactory.dbQuery(DatabaseFactory.kt:48)
	at cn.com.lushunming.service.TaskService.updateProgress(TaskService.kt:38)
	at cn.com.lushunming.server.M3U8Downloader$downloadAllFiles$3$1.invokeSuspend(M3U8Downloader.kt:105)
	at kotlin.coroutines.jvm.internal.BaseContinuationImpl.resumeWith$$$capture(ContinuationImpl.kt:33)
	at kotlin.coroutines.jvm.internal.BaseContinuationImpl.resumeWith(ContinuationImpl.kt)
	at kotlinx.coroutines.DispatchedTask.run(DispatchedTask.kt:100)
	at kotlinx.coroutines.internal.LimitedDispatcher$Worker.run(LimitedDispatcher.kt:124)
	at kotlinx.coroutines.scheduling.TaskImpl.run(Tasks.kt:89)
	at kotlinx.coroutines.scheduling.CoroutineScheduler.runSafely(CoroutineScheduler.kt:586)
	at kotlinx.coroutines.scheduling.CoroutineScheduler$Worker.executeTask(CoroutineScheduler.kt:820)
	at kotlinx.coroutines.scheduling.CoroutineScheduler$Worker.runWorker(CoroutineScheduler.kt:717)
	at kotlinx.coroutines.scheduling.CoroutineScheduler$Worker.run(CoroutineScheduler.kt:704)
Caused by: org.h2.mvstore.MVStoreException:  [2.2.224/105]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.tx.TxDecisionMaker$RepeatableReadLockDecisionMaker.logAndDecideToPut(TxDecisionMaker.java:378)
	at org.h2.mvstore.tx.TxDecisionMaker.decide(TxDecisionMaker.java:80)
	at org.h2.mvstore.tx.TxDecisionMaker$LockDecisionMaker.decide(TxDecisionMaker.java:346)
	at org.h2.mvstore.tx.TxDecisionMaker$LockDecisionMaker.decide(TxDecisionMaker.java:338)
	at org.h2.mvstore.MVMap$DecisionMaker.decide(MVMap.java:1701)
	at org.h2.mvstore.MVMap.operate(MVMap.java:1775)
	at org.h2.mvstore.tx.TransactionMap.set(TransactionMap.java:363)
	at org.h2.mvstore.tx.TransactionMap.lock(TransactionMap.java:329)
	at org.h2.mvstore.db.MVPrimaryIndex.lockRow(MVPrimaryIndex.java:225)
	... 43 more
